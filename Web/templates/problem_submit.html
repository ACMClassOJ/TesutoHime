{% extends 'base.html' %}

{% set page='提交' %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('.static', filename = 'lib/bootstrap-select.min.css') }}">
{% endblock %}

{% block content %}
    <div class="card card-body">
        <h1 class="text-center"> {{ Problem_ID }}. {{ Title }}</h1>
        <div class="nav-wrapper">
            <ul class="nav nav-pills nav-fill flex-column flex-md-row">
                <li class="nav-item">
                    <a class="nav-link mb-sm-2 mb-md-0" href="/OnlineJudge/problem/{{ Problem_ID }}">题面</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link mb-sm-2 mb-md-0 active" href="/OnlineJudge/problem/{{ Problem_ID }}/submit">提交</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link mb-sm-2 mb-md-0" href="/OnlineJudge/status?problem_id={{ Problem_ID }}">评测状态</a>
                </li>
                {% if not In_Exam -%}
                <li class="nav-item">
                    <a class="nav-link mb-sm-2 mb-md-0" href="/OnlineJudge/problem/{{ Problem_ID }}/discuss">讨论</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link mb-sm-2 mb-md-0" href="/OnlineJudge/problem/{{ Problem_ID }}/rank">排行榜</a>
                </li>
                {% endif %}
                {% if is_Admin %}
                <li class="nav-item">
                    <form id="formDataZipDownload" action="/OnlineJudge/admin/data_download" method="post">
                        <input type="hidden" name="id" id="datazip_download_problem_ID" value="{{ Problem_ID }}">    
                    </form>
                    <a class="nav-link mb-sm-2 mb-md-0" href="javascript:document.getElementById('formDataZipDownload').submit();"> 下载本题数据 </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link mb-sm-2 mb-md-0" href="/OnlineJudge/problem/{{ Problem_ID }}/admin"> 管理 </a>
                </li>
                {% endif %}
            </ul>
        </div>
    </div>
    <div class="card card-body">
        <style>
            .dropdown-header {
                color: inherit !important;
            }
            @media (prefers-color-scheme: dark) {
                html .dropdown-header {
                    color: rgba(255, 255, 255, 0.95) !important;
                }
            }
        </style>
        <form method="post" id="problem_submit_form">
            <div class="form-group">
                <label for="lang">语言</label>
                <select id="lang" name="lang" class="form-control input-group py-0 selectpicker"
                        data-style="form-control rounded border-grey shadow-none font-weight-normal">
                    <option value="auto_detect" selected="selected">自动检测</option>
                    {% for group in aflanguages %}
                    <optgroup label="{{ group }}">
                        {% for lang in aflanguages[group] %}
                        <option value="{{ lang['value'] }}">{{ lang['name'] }}</option>
                        {% endfor %}
                    </optgroup>
                    {% endfor %}
                </select>
            </div>
            <p>
                评测后端近日再次进行了升级，新增对 <strong>Java、Python、Brainf***、System F、汉语</strong>等 <strong>42 种语言</strong>的支持，这些语言正处于公测阶段，后续将视测试情况决定是否上线。2023.4.1
                <small>具体用法请自行尝试提交。ACMOJ 对使用测试功能造成的一切损失概不负责。</small>
            </p>
            <div class="row mx-0">
                <label for="code">代码</label>
                {% if not In_Exam -%}
                    <div class="form-group ml-auto">
                        <div class="custom-control custom-switch">
                            <input class="custom-control-input" type="checkbox" name="shared" id="shared"
                                   value="shared">
                            <label class="custom-control-label" for="shared">代码对他人可见</label>
                        </div>
                    </div>
                {%- endif %}
            </div>
            <textarea class="form-control mb-3" rows="18" id="code" name="code" required="required"></textarea>
            <input type="hidden" name="problem_id" value="{{ Problem_ID }}">
            <input type="submit" class="btn btn-block btn-primary" value="提交评测">
        </form>
    </div>
{% endblock %}

{% block script %}
    <script src="{{ url_for('.static', filename = 'lib/bootstrap-select.min.js') }}"></script>
    <script src="{{ url_for('.static', filename = 'js/problem_submit.js') }}?v=20230401"></script>
{% endblock %}
