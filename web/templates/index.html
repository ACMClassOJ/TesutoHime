{% extends 'base.html' %}

{% set page='主页' %}

{% block head %}
{%- if suggestions != None -%}
{{ render_styles() }}
<link rel="stylesheet" href="{{ url_for('.static', filename = 'lib/font-awesome/css/all.min.css') }}">
{%- endif -%}
{% endblock %}

{% block content %}
<div class="card card-body">
    <h1>Welcome to ACM Class OnlineJudge</h1>

    {% if news | length > 0 -%}
    <h4>新闻</h4>
    {% for item in news -%}
    <p>
        <a class="blog-post" href="{{ item['link'] }}">
            {%- if item['weight'] > 0 %}<strong>{% endif -%}
            <span class="blog-post__title">{{ item['title'] }}</span>
            <span class="blog-post__date">{{ g.utils.readable_date(item['date']) }}</span>
            {%- if item['weight'] > 0 %}</strong>{% endif -%}
        </a>
    </p>
    {%- endfor %}
    <p>
        <a href="{{ news_link }}">查看全部 →</a>
    </p>

    <hr class="my-4">

    {%- endif %}

    {%- if invited_courses != None and invited_courses | length > 0 -%}
    <h4 class="mb-3">待加入的班级</h4>
    <p>加入班级后，班级的管理员将可以看到您的全部提交代码，您将自动加入所有与您相关的作业、比赛和考试。</p>
    <div class="course-card-group">
        {%- for course in invited_courses -%}
        <a class="card card--small mb-3" href="{{ url_for('.course', course=course) }}">
            {%- if course.term != None or course.tag != None -%}
            <div class="card-header">
                {%- if course.term != None -%}
                {{ course.term.name }}
                {%- if course.tag != None %} &middot; {% endif -%}
                {%- endif -%}
                {%- if course.tag != None -%}
                {{ course.tag.name }}
                {%- endif -%}
            </div>
            {%- endif -%}
            <div class="card-body">
                <span class="card--course__name">{{ course.name }}</span>
                <span class="card--course__actions float-right">
                    <form action="{{ url_for('.course_ignore', course=course) }}" method="POST" onsubmit="return confirm('确认要忽略班级吗？忽略班级后，可以在班级列表中加入班级。')" class="d-inline">
                        {{ g.csrf() }}
                        <button type="submit" class="btn btn-outline-primary btn-sm">忽略</button>
                    </form>
                    <form action="{{ url_for('.course_join', course=course) }}" method="POST" class="d-inline">
                        {{ g.csrf() }}
                        <button type="submit" class="btn btn-primary btn-sm">加入</button>
                    </form>
                </span>
            </div>
        </a>
        {%- endfor -%}
    </div>
    <hr class="my-4">
    {%- endif -%}

    {%- if suggestions != None -%}
    <!-- <h4>我的比赛和作业</h4> -->
    {%- for type in 'in-progress', 'future', 'past' -%}
    {%- set contests = suggestions[type] -%}
    {%- if contests | length > 0 -%}
    <h4 class="mb-3">{{ { 'in-progress': '正在进行', 'future': '即将开始', 'past': '刚刚结束' }[type] }}</h4>
    <div class="contest-card-group">
        {%- for contest in contests -%}
        {{ contest_card(contest) }}
        {%- endfor -%}
    </div>
    <hr>
    {%- endif -%}
    {%- endfor -%}
    {%- endif -%}

    {% if g.is_admin -%}
    <p><strong>邀请您加入 ACMOJ 助教 QQ 群: 942621107</strong>（此消息仅对助教显示，请勿拉学生入群。）</p>
    {%- endif %}
    <p>如需要管理员账户，以及对 OJ 有任何改进建议，欢迎邮件 ACM OJ 管理组。</p>
    <p>请所有助教在上题前阅读「帮助」界面中的相关文档，注意题面与数据格式的规范！</p>
    <p>联系管理组：<a href="mailto:acmclassoj@googlegroups.com">acmclassoj@googlegroups.com</a></p>
    <p>
        友情链接：<!--
     --><a class="mr-2" href="https://acm.sjtu.edu.cn/wiki/">课程 wiki</a><!--
     --><a class="mr-2" href="https://acm.sjtu.edu.cn/simulator/">伟大思想模拟器</a><!--
     --><a class="mr-2" href="https://zysalon.com/">致远沙龙查询</a><!--
     --><a class="mr-2" href="https://stats.uptimerobot.com/NB3PWFZGAk">OJ 炸了吗</a>
    </p>
</div>
{% endblock %}

{% block script %}
{{ render_scripts() }}
{% endblock %}
